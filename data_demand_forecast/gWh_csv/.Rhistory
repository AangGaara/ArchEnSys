print(paste("Merging",filename,sep = " "))
read.xlsx(filename)
})
df <- do.call(rbind.data.frame, All)
write.xlsx(df,"data_demnad_forecast/gwh_2011_2019")
write.xlsx(df,"data_demand_forecast/gwh_2011_2019")
library(readxl)
library(openxlsx)
# generation data (GWh) from BPS, stored locally in github folder
gwh_2011_2012 <- read_excel("data_demand_forecast/generation_gwh_2011_2012.xlsx")
gwh_2013_2015 <- read_excel("data_demand_forecast/generation_gwh_2013_2015.xlsx")
gwh_2017_2019 <- read_excel("data_demand_forecast/generation_gwh_2013_2015.xlsx")
#view(gwh_2011_2012)
#View(gwh_2013_2015)
#View(gwh_2017_2019)
#merge files into one
# from https://medium.com/@niharika.goel/merge-multiple-csv-excel-files-in-a-folder-using-r-e385d962a90a
gwh_path <- "data_demand_forecast/gwh"
gwh_list <- list.files(path= gwh_path, full.names=TRUE)
All <- lapply(gwh_list,function(filename){
print(paste("Merging",filename,sep = " "))
read.xlsx(filename)
})
df <- do.call(rbind.data.frame, All)
write.xlsx(df,"data_demand_forecast/gwh_2011_2019")
# generation data (GWh) from BPS, stored locally in github folder
gwh_2011_2012 <- read_excel("data_demand_forecast/generation_gwh_2011_2012.xlsx")
# generation data (GWh) from BPS, stored locally in github folder
gwh_2011_2012 <- read_excel("data_demand_forecast/generation_gwh_2011_2012.xlsx")
# generation data (GWh) from BPS, stored locally in github folder
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx")
read(gwh_2011_2012)
#merge files into one
dir("data_demand_forecast/gWh", full.names=T)
#merge files into one
dir("data_demand_forecast/gWh", full.names=T) %>% map_df(read_xlsx)
library(readxl)
library(tidyverse)
# generation data (GWh) from BPS, stored locally in github folder
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx")
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx")
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx")
#view(gwh_2011_2012)
#View(gwh_2013_2015)
#View(gwh_2017_2019)
#merge files into one
dir("data_demand_forecast/gWh", full.names=T) %>% map_df(read_xlsx)
write_csv(gwh_2011_2012, path="data-demand_forecast/gWh/gwh_2011_2021.csv")
write_csv(gwh_2011_2012, path="data_demand_forecast/gWh/gwh_2011_2021.csv")
library(readxl)
library(tidyverse)
# generation data (GWh) from BPS, stored locally in github folder
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx")
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx")
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx")
write_csv(gwh_2011_2012, path="data_demand_forecast/gWh/gwh_2011_2011.csv")
write_csv(gwh_2013_2015, path="data_demand_forecast/gWh/gwh_2013_2015.csv")
write_csv(gwh_2017_2019, path="data_demand_forecast/gWh/gwh_2017_2019.csv")
#view(gwh_2011_2012)
#View(gwh_2013_2015)
#View(gwh_2017_2019)
#merge files into one
dir("data_demand_forecast/gWh", full.names=T) %>% map_df(read_csv)
#merge files into one
dir("data_demand_forecast/gWh", full.names=T) %>% map_df(read_xlsx)
library(readxl)
library(tidyverse)
# generation data (GWh) from BPS, stored locally in github folder
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx")
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx")
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx")
#write_csv(gwh_2011_2012, path="data_demand_forecast/gWh/gwh_2011_2011.csv")
#write_csv(gwh_2013_2015, path="data_demand_forecast/gWh/gwh_2013_2015.csv")
#write_csv(gwh_2017_2019, path="data_demand_forecast/gWh/gwh_2017_2019.csv")
#view(gwh_2011_2012)
#View(gwh_2013_2015)
#View(gwh_2017_2019)
#merge files into one
dir("data_demand_forecast/gWh", full.names=T) %>% map_df(read_xlsx)
#merge files into one
dir("data_demand_forecast/gWh", full.names=T) %>% map_df(read_xlsx)
#merge files into one
gwh_list <- dir("data_demand_forecast/gWh", full.names=T) %>% map_df(read_xlsx)
View(gwh_list)
gwh_province  <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A3:A37")
library(readxl)
library(tidyverse)
# generation data (GWh) from BPS, stored locally in github folder
gwh_province  <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A3:A37")
library(readxl)
library(tidyverse)
# generation data (GWh) from BPS, stored locally in github folder
gwh_province  <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A3:A37")
gwh_province  <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A3:A37")
View(gwh_province)
??readxl
gwh_province  <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A3:A37", col_names= FALSE)
gwh_province  <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A3:A37", col_names= FALSE)
View(gwh_province)
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "B3:C37", col_names= FALSE)
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B3:D37", col_names= FALSE)
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B3:D37", col_names= FALSE)
??write_excel
??writexl
gwh_province  <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:A37", col_names= FALSE)
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "B2:C37", col_names= FALSE)
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "B2:C37", col_names= FALSE)
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names= FALSE)
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names= FALSE)
#write_csv(gwh_2011_2012, path="data_demand_forecast/gWh/gwh_2011_2011.csv")
View(gwh_2011_2012)
gwh_province  <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:A37")
View(gwh_province)
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "B2:C37")
View(gwh_2011_2012)
ibrary(readxl)
library(tidyverse)
# generation data (GWh) from BPS, stored locally in github folder
gwh_province  <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A3:A37", col_names= FALSE)
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "B3:C37", col_names= FALSE)
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B3:D37", col_names= FALSE)
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B3:D37", col_names= FALSE)
#write_csv(gwh_2011_2012, path="data_demand_forecast/gWh/gwh_2011_2011.csv")
#write_csv(gwh_2013_2015, path="data_demand_forecast/gWh/gwh_2013_2015.csv")
#write_csv(gwh_2017_2019, path="data_demand_forecast/gWh/gwh_2017_2019.csv")
#view(gwh_2011_2012)
#View(gwh_2013_2015)
#View(gwh_2017_2019)
#merge files into one
gwh_list <- dir("data_demand_forecast/gWh", full.names=T) %>% map_df(read_xlsx)
??readxl
gwh_province  <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A3:A37", col_names= FALSE))
gwh_province  <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A3:A37", col_names= FALSE))
View(gwh_province)
#merge files into one
gwh_list <- dir("data_demand_forecast/gWh", full.names=T) %>% map_df(t(read_xlsx)
#merge files into one
gwh_list <- dir("data_demand_forecast/gWh", full.names=T) %>% map_df(t(read_xlsx))
#merge files into one
gwh_list <- dir("data_demand_forecast/gWh", full.names=T) %>% map_df(read_xlsx)
View(gwh_list)
gwh_2011_2012 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "B3:C37", col_names= FALSE))
View(gwh_2011_2012)
gwh_2011_2012 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "B2:C37", col_names= FALSE))
View(gwh_2011_2012)
??writexl
??str
library(readxl)
library(tidyverse)
# generation data (GWh) from BPS, stored locally in github folder
# read-transpose-merge-transpose
gwh_province  <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A3:A37", col_names= FALSE))
gwh_2011_2012 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "B2:C37", col_names= FALSE))
gwh_2013_2015 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names= FALSE))
gwh_2017_2019 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names= FALSE))
write_csv(gwh_2011_2012, path="data_demand_forecast/gWh_csv/gwh_2011_2011.csv")
write_csv(gwh_2013_2015, path="data_demand_forecast/gWh_csv/gwh_2013_2015.csv")
write_csv(gwh_2017_2019, path="data_demand_forecast/gWh_csv/gwh_2017_2019.csv")
#view(gwh_2011_2012)
#View(gwh_2013_2015)
#View(gwh_2017_2019)
#merge files into one
gwh_list <- dir("data_demand_forecast/gWh", full.names=T) %>% map_df(read_csv)
library(readxl)
library(tidyverse)
# generation data (GWh) from BPS, stored locally in github folder
# read-transpose-merge-transpose
gwh_province  <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A3:A37", col_names= FALSE))
gwh_2011_2012 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "B2:C37", col_names= FALSE))
gwh_2013_2015 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names= FALSE))
gwh_2017_2019 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names= FALSE))
write_csv(gwh_2011_2012, path="data_demand_forecast/gWh_csv/gwh_2011_2011.csv")
write_csv(gwh_2013_2015, path="data_demand_forecast/gWh_csv/gwh_2013_2015.csv")
write_csv(gwh_2017_2019, path="data_demand_forecast/gWh_csv/gwh_2017_2019.csv")
#view(gwh_2011_2012)
#View(gwh_2013_2015)
#View(gwh_2017_2019)
#merge files into one
gwh_list <- dir("data_demand_forecast/gWh_csv", full.names=T) %>% map_df(read_csv)
View(gwh_list)
#merge files into one
gwh_list <- dir("data_demand_forecast/gWh_csv", full.names=T) %>% map_df(read_csv)
library(readxl)
library(tidyverse)
# generation data (GWh) from BPS, stored locally in github folder
# read-transpose-merge-transpose
gwh_province  <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:A37", col_names= FALSE))
gwh_2011_2012 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "B2:C37", col_names= FALSE))
gwh_2013_2015 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names= FALSE))
gwh_2017_2019 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names= FALSE))
write_csv(province, path="data_demand_forecast/gWh_csv/province.csv")
write_csv(gwh_province, path="data_demand_forecast/gWh_csv/province.csv")
write_xlsx(gwh_province, path="data_demand_forecast/gWh_csv/province.csv")
writexl(gwh_province, path="data_demand_forecast/gWh_csv/province.xlsx")
write_csv(gwh_2011_2012, path="data_demand_forecast/gWh_csv/gwh_2011_2011.csv")
write.csv(gwh_province, path="data_demand_forecast/gWh_csv/province.csv")
??write_csv
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv")
write_csv(gwh_2011_2012, "data_demand_forecast/gWh_csv/gwh_2011_2011.csv")
write.csv(gwh_2011_2012, "data_demand_forecast/gWh_csv/gwh_2011_2011.csv")
write_csv(gwh_2013_2015, "data_demand_forecast/gWh_csv/gwh_2013_2015.csv")
write_csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv")
library(readxl)
library(tidyverse)
# generation data (GWh) from BPS, stored locally in github folder
# read-transpose-merge-transpose
gwh_province  <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:A37", col_names= FALSE))
gwh_2011_2012 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "B2:C37", col_names= FALSE))
gwh_2013_2015 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names= FALSE))
gwh_2017_2019 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names= FALSE))
write_csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv")
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv")
write.csv(gwh_2017_2019, "data_demand_forecast/gWh_csv/gwh_2017_2019.csv")
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv")
write.csv(gwh_2011_2012, "data_demand_forecast/gWh_csv/gwh_2011_2011.csv")
write.csv(gwh_2013_2015, "data_demand_forecast/gWh_csv/gwh_2013_2015.csv")
write.csv(gwh_2017_2019, "data_demand_forecast/gWh_csv/gwh_2017_2019.csv")
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv", col_names = TRUE)
View(gwh_2011_2012)
??read_excel
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv")
write.csv(gwh_2011_2012, "data_demand_forecast/gWh_csv/gwh_2011_2011.csv")
write.csv(gwh_2013_2015, "data_demand_forecast/gWh_csv/gwh_2013_2015.csv")
write.csv(gwh_2017_2019, "data_demand_forecast/gWh_csv/gwh_2017_2019.csv")
View(gwh_2011_2012)
??write.csv
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv",row.names=FALSE)
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv",row.names=FALSE, col.names=FALSE)
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv",row.names=FALSE, col.names=NA)
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv",row.names=FALSE, col.names=TRUE)
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv",row.names=FALSE, col.names=FALSE)
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv",row.names=FALSe)
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv",row.names=FALSE)
# generation data (GWh) from BPS, stored locally in github folder
# read-transpose-merge-transpose
gwh_province  <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:A37",))
View(gwh_province)
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv",row.names=FALSE,col.names = FALSE)
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv", row.names = FALSE, col.names = FALSE)
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv", row.names = FALSE, col.names = FALSE)
write.csv(gwh_2011_2012, "data_demand_forecast/gWh_csv/gwh_2011_2011.csv", row.names = FALSE, col.names = FALSE)
View(gwh_2011_2012)
# generation data (GWh) from BPS, stored locally in github folder
# read-transpose-merge-transpose
gwh_province  <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:A37"))
# generation data (GWh) from BPS, stored locally in github folder
# read-transpose-merge-transpose
gwh_province  <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:A37"))
View(gwh_province)
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv", row.names = FALSE, col.names = FALSE)
# generation data (GWh) from BPS, stored locally in github folder
# read-transpose-merge-transpose
gwh_province  <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:A37", col_names = FALSE))
library(readxl)
library(tidyverse)
# generation data (GWh) from BPS, stored locally in github folder
# read-transpose-merge-transpose
gwh_province  <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:A37", col_names = FALSE))
gwh_2011_2012 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "B2:C37", col_names = FALSE))
gwh_2013_2015 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names = FALSE))
gwh_2017_2019 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names = FALSE))
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv", row.names = FALSE, col.names = FALSE)
write.csv(gwh_2011_2012, "data_demand_forecast/gWh_csv/gwh_2011_2011.csv", row.names = FALSE, col.names = FALSE)
write.csv(gwh_2013_2015, "data_demand_forecast/gWh_csv/gwh_2013_2015.csv", row.names = FALSE, col.names = FALSE)
write.csv(gwh_2017_2019, "data_demand_forecast/gWh_csv/gwh_2017_2019.csv", row.names = FALSE, col.names = FALSE)
#view(gwh_2011_2012)
#View(gwh_2013_2015)
#View(gwh_2017_2019)
#merge files into one
gwh_list <- dir("data_demand_forecast/gWh_csv", full.names=T) %>% map_df(read_csv)
#merge files into one
gwh_list <- dir("data_demand_forecast/gWh_csv", full.names=T) %>% map_df(read_csv)
#merge files into one
gwh_list <- dir("data_demand_forecast/gWh_csv", full.names=T) %>% map_df(read_csv)
#merge files into one
gwh_list <- dir("data_demand_forecast/gWh_csv", full.names=T) %>% map_df(read_csv)
write_excel_csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv", row.names = FALSE, col.names = FALSE)
write.csv(gwh_2011_2012, "data_demand_forecast/gWh_csv/gwh_2011_2012.csv", row.names = FALSE, col.names = FALSE)
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv", row.names = FALSE, col.names = FALSE)
??merge
authors <- data.frame(
## I(*) : use character columns of names to get sensible sort order
surname = I(c("Tukey", "Venables", "Tierney", "Ripley", "McNeil")),
nationality = c("US", "Australia", "US", "UK", "Australia"),
deceased = c("yes", rep("no", 4)))
authorN <- within(authors, { name <- surname; rm(surname) })
books <- data.frame(
name = I(c("Tukey", "Venables", "Tierney",
"Ripley", "Ripley", "McNeil", "R Core")),
title = c("Exploratory Data Analysis",
"Modern Applied Statistics ...",
"LISP-STAT",
"Spatial Statistics", "Stochastic Simulation",
"Interactive Data Analysis",
"An Introduction to R"),
other.author = c(NA, "Ripley", NA, NA, NA, NA,
"Venables & Smith"))
(m0 <- merge(authorN, books))
(m1 <- merge(authors, books, by.x = "surname", by.y = "name"))
m2 <- merge(books, authors, by.x = "name", by.y = "surname")
stopifnot(exprs = {
identical(m0, m2[, names(m0)])
as.character(m1[, 1]) == as.character(m2[, 1])
all.equal(m1[, -1], m2[, -1][ names(m1)[-1] ])
identical(dim(merge(m1, m2, by = NULL)),
c(nrow(m1)*nrow(m2), ncol(m1)+ncol(m2)))
})
## "R core" is missing from authors and appears only here :
merge(authors, books, by.x = "surname", by.y = "name", all = TRUE)
## example of using 'incomparables'
x <- data.frame(k1 = c(NA,NA,3,4,5), k2 = c(1,NA,NA,4,5), data = 1:5)
y <- data.frame(k1 = c(NA,2,NA,4,5), k2 = c(NA,NA,3,4,5), data = 1:5)
merge(x, y, by = c("k1","k2")) # NA's match
merge(x, y, by = "k1") # NA's match, so 6 rows
merge(x, y, by = "k2", incomparables = NA) # 2 rows
rm(list = ls())
library(readxl)
library(tidyr)
setwd("data_demand_forecast/gWh")
my_files <-list.files(.pattern="*.xlsx")
my_files <-list.files(pattern="*.xlsx")
my_files
x
nba = lapply(my_files, function(i){
x = read_excel(I,sheet=1)
x$file=i
x
})
x = read_excel(i,sheet=1)
x$file=i
x
rm(list = ls())
library(readxl)
library(tidyr)
setwd("data_demand_forecast/gWh")
setwd("data_demand_forecast/gWh")
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys")
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys")
my_files <-list.files(pattern="*.xlsx")
my_files
nba = lapply(my_files, function(i){
x = read_excel(i,sheet=1)
x$file=i
x
})
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys/ata_demand_forecast/gWh")
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys/data_demand_forecast/gWh")
my_files <-list.files(pattern="*.xlsx")
my_files
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys")
??list.files
my_files <-list.files("data_demand_forecast/gWh", pattern="*.xlsx")
my_files
nba = lapply(my_files, function(i){
x = read_excel(i,sheet=1)
x$file=i
x
})
rm(list = ls())
library(readxl)
library(tidyr)
my_files <-list.files("data_demand_forecast/gWh", pattern="*.xlsx")
my_files
nba = lapply(my_files, function(i){
x = read_excel(i,sheet=1)
x$file=i
x
})
nba = lapply(my_files, function(i){
x = read_excel(i,sheet=1)
x$file=i
x
})
??lapply
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys/data_demand_forecast/gWh")
rm(list = ls())
library(readxl)
library(tidyr)
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys/data_demand_forecast/gWh")
my_files <-list.files(pattern="*.xlsx")
my_files
nba = lapply(my_files, function(i){
x = read_excel(i,sheet=1)
x$file=i
x
})
nba = do.call("rbing.data.frame",nba)
nba = do.call("rbind.data.frame",nba)
nba[[2]]
nba = do.call("rbind.data.frame",nba)
nba[[2]]
View(nba)
View(nba)
library(readxl)
library(tidyverse)
# generation data (GWh) from BPS, stored locally in github folder
# read-transpose-merge-transpose
gwh_province  <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:A37", col_names = FALSE)
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "B2:C37", col_names = FALSE)
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names = FALSE)
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names = FALSE)
#gwh_province  <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:A37", col_names = FALSE))
#gwh_2011_2012 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "B2:C37", col_names = FALSE))
#gwh_2013_2015 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names = FALSE))
#gwh_2017_2019 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names = FALSE))
merge
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv", row.names = FALSE, col.names = FALSE)
write.csv(gwh_2011_2012, "data_demand_forecast/gWh_csv/gwh_2011_2011.csv", row.names = FALSE, col.names = FALSE)
write.csv(gwh_2013_2015, "data_demand_forecast/gWh_csv/gwh_2013_2015.csv", row.names = FALSE, col.names = FALSE)
write.csv(gwh_2017_2019, "data_demand_forecast/gWh_csv/gwh_2017_2019.csv", row.names = FALSE, col.names = FALSE)
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys")
library(readxl)
library(tidyverse)
# generation data (GWh) from BPS, stored locally in github folder
# read-transpose-merge-transpose
gwh_province  <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:A37", col_names = FALSE)
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "B2:C37", col_names = FALSE)
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names = FALSE)
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names = FALSE)
#gwh_province  <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:A37", col_names = FALSE))
#gwh_2011_2012 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "B2:C37", col_names = FALSE))
#gwh_2013_2015 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names = FALSE))
#gwh_2017_2019 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names = FALSE))
merge
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv", row.names = FALSE, col.names = FALSE)
write.csv(gwh_2011_2012, "data_demand_forecast/gWh_csv/gwh_2011_2011.csv", row.names = FALSE, col.names = FALSE)
write.csv(gwh_2013_2015, "data_demand_forecast/gWh_csv/gwh_2013_2015.csv", row.names = FALSE, col.names = FALSE)
write.csv(gwh_2017_2019, "data_demand_forecast/gWh_csv/gwh_2017_2019.csv", row.names = FALSE, col.names = FALSE)
library(readxl)
library(tidyverse)
# generation data (GWh) from BPS, stored locally in github folder
# read-transpose-merge-transpose
gwh_province  <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:A37", col_names = FALSE)
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "B2:C37", col_names = FALSE)
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names = FALSE)
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names = FALSE)
#gwh_province  <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:A37", col_names = FALSE))
#gwh_2011_2012 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "B2:C37", col_names = FALSE))
#gwh_2013_2015 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names = FALSE))
#gwh_2017_2019 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names = FALSE))
merge
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv", row.names = FALSE, col.names = FALSE)
write.csv(gwh_2011_2012, "data_demand_forecast/gWh_csv/gwh_2011_2012.csv", row.names = FALSE, col.names = FALSE)
write.csv(gwh_2013_2015, "data_demand_forecast/gWh_csv/gwh_2013_2015.csv", row.names = FALSE, col.names = FALSE)
write.csv(gwh_2017_2019, "data_demand_forecast/gWh_csv/gwh_2017_2019.csv", row.names = FALSE, col.names = FALSE)
#view(gwh_2011_2012)
#View(gwh_2013_2015)
#View(gwh_2017_2019)
library(readxl)
library(tidyverse)
# generation data (GWh) from BPS, stored locally in github folder
# read-transpose-merge-transpose
gwh_province  <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:A37", col_names = FALSE)
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "B2:C37", col_names = FALSE)
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names = FALSE)
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names = FALSE)
#gwh_province  <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:A37", col_names = FALSE))
#gwh_2011_2012 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "B2:C37", col_names = FALSE))
#gwh_2013_2015 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names = FALSE))
#gwh_2017_2019 <- t(read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "B2:D37", col_names = FALSE))
merge
write.csv(gwh_province, "data_demand_forecast/gWh_csv/province.csv", row.names = FALSE, col.names = FALSE)
write.csv(gwh_2011_2012, "data_demand_forecast/gWh_csv/gwh_2011_2012.csv", row.names = FALSE, col.names = FALSE)
write.csv(gwh_2013_2015, "data_demand_forecast/gWh_csv/gwh_2013_2015.csv", row.names = FALSE, col.names = FALSE)
write.csv(gwh_2017_2019, "data_demand_forecast/gWh_csv/gwh_2017_2019.csv", row.names = FALSE, col.names = FALSE)
#view(gwh_2011_2012)
#View(gwh_2013_2015)
#View(gwh_2017_2019)
#merge files into one
gwh_list <- dir("data_demand_forecast/gWh_csv", full.names=T) %>% map_df(read_csv)
rm(list = ls())
library(readxl)
library(tidyr)
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys/data_demand_forecast/gWh_csv")
my_files <-list.files(pattern="*.csv")
my_files
nba = lapply(my_files, function(i){
x = read_excel(i,sheet=1)
x$file=i
x
})
nba[[2]]
nba = do.call("rbind.data.frame",nba)
rm(list = ls())
library(readxl)
library(tidyr)
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys/data_demand_forecast/gWh_csv")
my_files <-list.files(pattern="*.csv")
my_files
nba = lapply(my_files, function(i){
x = read_excel(i,sheet=1)
x$file=i
x
})
nba[[2]]
x = read.csv(i,sheet=1)
x = read.csv(i)
x = read_csv(i)
rm(list = ls())
library(readxl)
library(tidyr)
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys/data_demand_forecast/gWh_csv")
my_files <-list.files(pattern="*.csv")
my_files
nba = lapply(my_files, function(i){
x = read_csv(i)
x$file=i
x
})
nba[[2]]
nba = do.call("rbind.data.frame",nba)
View(nba)
