gwh_2011_2012_long <- pivot_longer(gwh_2011_2012, cols = 2:3, names_to = "year", values_to = "gWh")
gwh_2013_2015_long <- pivot_longer(gwh_2013_2015, cols = 2:4, names_to = "year", values_to = "gWh")
gwh_2017_2019_long <- pivot_longer(gwh_2017_2019, cols = 2:4, names_to = "year", values_to = "gWh")
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gWh_2013_2015_long,gWh_2017_2019_long)
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
#remove all spaces, and convert comma to dot
as.data.frame(apply(gwh_2011_2019,2,function(x) gsub("\\s+", "", x)))
View(gwh_2011_2019)
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
#remove all spaces, and convert comma to dot
as.data.frame(apply(gwh_2011_2019,4,function(x) gsub("\\s+", "", x)))
#remove all spaces, and convert comma to dot
as.data.frame(apply(gwh_2011_2019,3,function(x) gsub("\\s+", "", x)))
#remove all spaces, and convert comma to dot
as.data.frame(apply(gwh_2011_2019,2,function(x) gsub("\\s+", "", x)))
#remove all spaces, and convert comma to dot
as.data.frame(apply(gwh_2011_2019[3],2,function(x) gsub("\\s+", "", x)))
#remove all spaces, and convert comma to dot
as.data.frame(apply(gwh_2011_2019[3],1,function(x) gsub("\\s+", "", x)))
#remove all spaces, and convert comma to dot
as.data.frame(apply(gwh_2011_2019[3],2,function(x) gsub("\\s+", "", x)))
#create long pivotted data
gwh_2011_2012_long <- pivot_longer(gwh_2011_2012, cols = 2:3, names_to = "year", values_to = "gWh")
gwh_2013_2015_long <- pivot_longer(gwh_2013_2015, cols = 2:4, names_to = "year", values_to = "gWh")
gwh_2017_2019_long <- pivot_longer(gwh_2017_2019, cols = 2:4, names_to = "year", values_to = "gWh")
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
#remove all spaces, and convert comma to dot
as.data.frame(apply(gwh_2011_2019[3],2,function(x) gsub("\\s+", "", x)))
View(gwh_2011_2019)
gsub("\\s+", "", gwh_2011_2019)
gsub("\\s+", "", gwh_2011_2019[3])
gsub(" ", "", gwh_2011_2019[3])
#merge all data
gwh_2011_2019 <- gsub(" ","",rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)[3])
#merge all data
gwh_2011_2019 <- gsub(" ","", rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long))
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
View(gwh_2011_2019)
gwh_2011_2019
gwh_2011_2019[3]
#remove all spaces, and convert comma to dot
gsub(" ", "", x)
x <- gwh_2011_2019[3]
#remove all spaces, and convert comma to dot
gsub(" ", "", x)
#remove all spaces, and convert comma to dot
gsub(" ", "", gsub(",",".",x))
x <- gwh_2011_2019[3]
#remove all spaces, and convert comma to dot
gsub(" ", "", gsub(",",".",x))
#remove all spaces, and convert comma to dot
gsub(" ", "", gsub(",",".",x <- gwh_2011_2019[3]))
#remove all spaces, and convert comma to dot
gsub(" ", "", gsub(",",".",x <- gwh_2011_2019[3]))
#remove all spaces, and convert comma to dot
as.data.frame(gsub(" ", "", gsub(",",".",x <- gwh_2011_2019[3]))
#remove all spaces, and convert comma to dot
as.data.frame(gsub(" ", "", gsub(",",".",x <- gwh_2011_2019[3])
#remove all spaces, and convert comma to dot
gwh_2011_2019[3] <- gsub(" ", "", gsub(",",".",x <- gwh_2011_2019[3]))
gwh_2011_2019
library(readxl)
library(tidyverse)
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys")
# generation data (GWh) from BPS, stored locally in github folder
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:C37", col_names = TRUE)
names(gwh_2011_2012)[1] <- "Province"
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2013_2015)[1] <- "Province"
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2017_2019.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2017_2019)[1] <- "Province"
#create long pivotted data
gwh_2011_2012_long <- pivot_longer(gwh_2011_2012, cols = 2:3, names_to = "year", values_to = "gWh")
gwh_2013_2015_long <- pivot_longer(gwh_2013_2015, cols = 2:4, names_to = "year", values_to = "gWh")
gwh_2017_2019_long <- pivot_longer(gwh_2017_2019, cols = 2:4, names_to = "year", values_to = "gWh")
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
#remove all spaces, and convert comma to dot
gwh_2011_2019[3] <- gsub(" ", "", gsub(",",".",x <- gwh_2011_2019[3]))
gwh_2011_2019
library(readxl)
library(tidyverse)
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys")
# generation data (GWh) from BPS, stored locally in github folder
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:C37", col_names = TRUE)
names(gwh_2011_2012)[1] <- "Province"
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2013_2015)[1] <- "Province"
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2017_2019.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2017_2019)[1] <- "Province"
#create long pivotted data
gwh_2011_2012_long <- pivot_longer(gwh_2011_2012, cols = 2:3, names_to = "year", values_to = "gWh")
gwh_2013_2015_long <- pivot_longer(gwh_2013_2015, cols = 2:4, names_to = "year", values_to = "gWh")
gwh_2017_2019_long <- pivot_longer(gwh_2017_2019, cols = 2:4, names_to = "year", values_to = "gWh")
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
#remove all spaces, and convert comma to dot
gwh_2011_2019[3] <- gsub(" ", "", gsub(",",".", gwh_2011_2019[3]))
gwh_2011_2019
View(gwh_2011_2019)
gwh_2011_2019[3]
#remove all spaces, and convert comma to dot
gwh_2011_2019[3] <- gsub("\\s+", "", gsub(",",".", gwh_2011_2019[3]))
gwh_2011_2019
library(readxl)
library(tidyverse)
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys")
# generation data (GWh) from BPS, stored locally in github folder
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:C37", col_names = TRUE)
names(gwh_2011_2012)[1] <- "Province"
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2013_2015)[1] <- "Province"
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2017_2019.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2017_2019)[1] <- "Province"
#create long pivotted data
gwh_2011_2012_long <- pivot_longer(gwh_2011_2012, cols = 2:3, names_to = "year", values_to = "gWh")
gwh_2013_2015_long <- pivot_longer(gwh_2013_2015, cols = 2:4, names_to = "year", values_to = "gWh")
gwh_2017_2019_long <- pivot_longer(gwh_2017_2019, cols = 2:4, names_to = "year", values_to = "gWh")
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
#remove all spaces, and convert comma to dot
gwh_2011_2019[3] <- gsub("\\s+", "", gsub(",",".", gwh_2011_2019[3]))
gwh_2011_2019
#remove all spaces, and convert comma to dot
gwh_2011_2019 <- apply(gwh_2011_2019, 1, gsub("\\s+", "", gsub(",",".", gwh_2011_2019[3])))
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
#remove all spaces, and convert comma to dot
gwh_2011_2019 <- apply(gwh_2011_2019, 1, gsub("\\s+", "", gsub(",",".", gwh_2011_2019[3])))
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
#remove all spaces, and convert comma to dot
gwh_2011_2019 <- apply(gwh_2011_2019, 2, gsub("\\s+", "", gsub(",",".", gwh_2011_2019[3])))
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
gwh_2011_2019
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
gwh_2011_2019
#remove all spaces, and convert comma to dot
as.data.frame(apply(gwh_2011_2019, 2, gsub("\\s+", "", gsub(",",".", gwh_2011_2019[3]))))
#remove all spaces, and convert comma to dot
as.data.frame(apply(gwh_2011_2019, 2, gsub("\\s+", "", gsub(",",".", gwh_2011_2019))))
gwh_2011_2019
#remove all spaces, and convert comma to dot
gsub("\\s+", "", gsub(",",".", gwh_2011_2019[3]))
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
#remove all spaces, and convert comma to dot
gsub(" ", "", gsub(",",".", gwh_2011_2019[3]))
#remove all spaces, and convert comma to dot
gsub(" ", "", gsub(",",".", gwh_2011_2019[3])
#remove all spaces, and convert comma to dot
x <- gsub(" ", "", gsub(",",".", gwh_2011_2019[3])
#remove all spaces, and convert comma to dot
x <- gsub(" ", "", gsub(",",".", gwh_2011_2019[3]))
x
#remove all spaces, and convert comma to dot
x <- gsub(" ", "", gsub(",",".", gwh_2011_2019))
x
#remove all spaces, and convert comma to dot
x <- gsub("\\s", "", gsub(",",".", gwh_2011_2019[3]))
x
??str_remove
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
gwh_2011_2019
#remove all spaces, and convert comma to dot
#x <- gsub("\\s", "", gsub(",",".", gwh_2011_2019[3]))
x <- str_remove(gwh_2011_2019[3], " ")
#remove all spaces, and convert comma to dot
#x <- gsub("\\s", "", gsub(",",".", gwh_2011_2019[3]))
x <- str_remove(gwh_2011_2019[2,3], " ")
x
#remove all spaces, and convert comma to dot
#x <- gsub("\\s", "", gsub(",",".", gwh_2011_2019[3]))
x <- str_remove(gwh_2011_2019[2,3], ",")
x
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
#remove all spaces, and convert comma to dot
#x <- gsub("\\s", "", gsub(",",".", gwh_2011_2019[3]))
x <- str_remove(gwh_2011_2019[3], "\\s")
#remove all spaces, and convert comma to dot
#x <- gsub("\\s", "", gsub(",",".", gwh_2011_2019[3]))
x <- sub(" ", "", gwh_2011_2019$gWh)
x
gwh_2011_2019[3]
#remove all spaces, and convert comma to dot
#x <- gsub("\\s", "", gsub(",",".", gwh_2011_2019[3]))
gwh_2011_2019[3] <- sub(" ", "", gwh_2011_2019$gWh)
gwh_2011_2019[3]
#remove all spaces, and convert comma to dot
#x <- gsub("\\s", "", gsub(",",".", gwh_2011_2019[3]))
gwh_2011_2019[3] <- sub("\\s", "", gwh_2011_2019$gWh)
gwh_2011_2019[3]
#remove all spaces, and convert comma to dot
#x <- gsub("\\s", "", gsub(",",".", gwh_2011_2019[3]))
gwh_2011_2019$gWh <- sub("\\s", "", gwh_2011_2019$gWh)
gwh_2011_2019[3]
#remove all spaces, and convert comma to dot
#x <- gsub("\\s", "", gsub(",",".", gwh_2011_2019[3]))
gwh_2011_2019$gWh'' <- sub("\\s", "", gwh_2011_2019$gWh)
#remove all spaces, and convert comma to dot
#x <- gsub("\\s", "", gsub(",",".", gwh_2011_2019[3]))
gwh_2011_2019$gWh <- sub("\\s", "", gwh_2011_2019$gWh)
gwh_2011_2019[3]
#remove all spaces, and convert comma to dot
#x <- gsub("\\s", "", gsub(",",".", gwh_2011_2019[3]))
gwh_2011_2019$gWh <- sub("\\s", "", gwh_2011_2019$gWh, fixed = TRUE)
gwh_2011_2019[3]
#remove all spaces, and convert comma to dot
#x <- gsub("\\s", "", gsub(",",".", gwh_2011_2019[3]))
gwh_2011_2019$gWh <- sub(",", ".", gwh_2011_2019$gWh, fixed = TRUE)
gwh_2011_2019[3]
#remove all spaces, and convert comma to dot
#x <- gsub("\\s", "", gsub(",",".", gwh_2011_2019[3]))
gwh_2011_2019$gWh <- sub(",", ".", gwh_2011_2019$gWh, fixed = TRUE)
gwh_2011_2019[3]
View(gwh_2011_2019)
gwh_2011_2019 <- mutate(gWh = str_remove(gWh, ficed("\\s")))
gwh_2011_2019 <- mutate(gWh = str_remove(gWh, fixed("\\s")))
gwh_2011_2019 <- mutate([3] = str_remove([3], fixed("\\s")))
gwh_2011_2019 <- mutate(gW = str_remove(gWh, fixed("\\s")))
gwh_2011_2019 %>%  mutate(gW = str_remove(gWh, fixed("\\s")))
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
#remove all spaces, and convert comma to dot
#x <- gsub("\\s", "", gsub(",",".", gwh_2011_2019[3]))
gwh_2011_2019$gWh <- sub(",", ".", gwh_2011_2019$gWh, fixed = TRUE)
gwh_2011_2019 %>%  mutate(gWh = str_remove(gWh, fixed("\\s")))
gwh_2011_2019[3]
gwh_2011_2019 %>%  mutate(gWh = str_remove(gWh, " "))
gwh_2011_2019[3]
gwh_2011_2019 %>%  mutate(gWh = str_remove(gWh, " "))
gwh_2011_2019[3]
View(gwh_2011_2019)
library(readxl)
library(tidyverse)
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys")
# generation data (GWh) from BPS, stored locally in github folder
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:C37", col_names = TRUE)
names(gwh_2011_2012)[1] <- "Province"
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2013_2015)[1] <- "Province"
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2017_2019.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2017_2019)[1] <- "Province"
#create long pivotted data
gwh_2011_2012_long <- pivot_longer(gwh_2011_2012, cols = 2:3, names_to = "year", values_to = "gWh")
gwh_2013_2015_long <- pivot_longer(gwh_2013_2015, cols = 2:4, names_to = "year", values_to = "gWh")
gwh_2017_2019_long <- pivot_longer(gwh_2017_2019, cols = 2:4, names_to = "year", values_to = "gWh")
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
#remove all spaces, and convert comma to dot
#x <- gsub("\\s", "", gsub(",",".", gwh_2011_2019[3]))
gwh_2011_2019$gWh <- sub(",", ".", gwh_2011_2019$gWh, fixed = TRUE)
gwh_2011_2019 %>%  mutate(gWh = str_remove(gWh, " "))
gwh_2011_2019[3]
View(gwh_2011_2019)
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
gwh_2011_2019[3]
#remove all spaces, and convert comma to dot
#gwh_2011_2019$gWh <- sub(",", ".", gwh_2011_2019$gWh, fixed = TRUE)
gwh_2011_2019 %>%  mutate(gWh = str_remove(gWh, ","))
gwh_2011_2019[3]
#remove all spaces, and convert comma to dot
#gwh_2011_2019$gWh <- sub(",", ".", gwh_2011_2019$gWh, fixed = TRUE)
gwh_2011_2019 <- gwh_2011_2019 %>%  mutate(gWh = str_remove(gWh, ","))
gwh_2011_2019[3]
#remove all spaces, and convert comma to dot
#gwh_2011_2019$gWh <- sub(",", ".", gwh_2011_2019$gWh, fixed = TRUE)
gwh_2011_2019 <- gwh_2011_2019 %>%  mutate(gWh = str_remove(gWh, " "))
gwh_2011_2019[3]
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
gwh_2011_2019[3]
#remove all spaces, and convert comma to dot
gwh_2011_2019$gWh <- sub(",", ".", gwh_2011_2019$gWh, fixed = TRUE)
gwh_2011_2019[3]
gwh_2011_2019 <- gwh_2011_2019 %>%  mutate(gWh = str_remove(gWh, " "))
gwh_2011_2019[3]
gwh_2011_2019 <- gwh_2011_2019 %>%  mutate(gWh = str_remove(gWh, "\\s"))
gwh_2011_2019[3]
View(gwh_2011_2019)
library(readxl)
library(tidyverse)
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys")
# generation data (GWh) from BPS, stored locally in github folder
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:C37", col_names = TRUE)
names(gwh_2011_2012)[1] <- "Province"
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2013_2015)[1] <- "Province"
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2017_2019.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2017_2019)[1] <- "Province"
#create long pivoted data
gwh_2011_2012_long <- pivot_longer(gwh_2011_2012, cols = 2:3, names_to = "year", values_to = "gWh")
gwh_2013_2015_long <- pivot_longer(gwh_2013_2015, cols = 2:4, names_to = "year", values_to = "gWh")
gwh_2017_2019_long <- pivot_longer(gwh_2017_2019, cols = 2:4, names_to = "year", values_to = "gWh")
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
#remove all spaces, and convert comma to dot
gwh_2011_2019$gWh <- sub(",", ".", gwh_2011_2019$gWh, fixed = TRUE)
gwh_2011_2019 <- gwh_2011_2019 %>%  mutate(gWh = str_remove(gWh, "\\s"))
gwh_2011_2019[3]
#write csv
write_csv("data_demand_forecast/gwh_2011_2019.csv")
View(gwh_2011_2019)
#write csv
write_csv("data_demand_forecast/gwh_2011_2019.csv")
#write csv
write_csv(gwh_2011_2019, "data_demand_forecast/gwh_2011_2019.csv")
library(readxl)
library(tidyverse)
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys")
# generation data (GWh) from BPS, stored locally in github folder
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:C37", col_names = TRUE)
names(gwh_2011_2012)[1] <- "Province"
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2013_2015)[1] <- "Province"
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2017_2019.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2017_2019)[1] <- "Province"
#create long pivoted data
gwh_2011_2012_long <- pivot_longer(gwh_2011_2012, cols = 2:3, names_to = "year", values_to = "generation_gWh")
gwh_2013_2015_long <- pivot_longer(gwh_2013_2015, cols = 2:4, names_to = "year", values_to = "generation_gWh")
gwh_2017_2019_long <- pivot_longer(gwh_2017_2019, cols = 2:4, names_to = "year", values_to = "generation_gWh")
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
#remove all spaces, and convert comma to dot
gwh_2011_2019$gWh <- sub(",", ".", gwh_2011_2019$gWh, fixed = TRUE)
gwh_2011_2019 <- gwh_2011_2019 %>%  mutate(gWh = str_remove(gWh, "\\s"))
gwh_2011_2019[3]
#write csv
write_csv(gwh_2011_2019, "data_demand_forecast/gwh_2011_2019.csv")
View(gwh_2011_2019)
library(readxl)
library(tidyverse)
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys")
# generation data (GWh) from BPS, stored locally in github folder
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:C37", col_names = TRUE)
names(gwh_2011_2012)[1] <- "Province"
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2013_2015)[1] <- "Province"
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2017_2019.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2017_2019)[1] <- "Province"
#create long pivoted data
gwh_2011_2012_long <- pivot_longer(gwh_2011_2012, cols = 2:3, names_to = "year", values_to = "generation_gWh")
gwh_2013_2015_long <- pivot_longer(gwh_2013_2015, cols = 2:4, names_to = "year", values_to = "generation_gWh")
gwh_2017_2019_long <- pivot_longer(gwh_2017_2019, cols = 2:4, names_to = "year", values_to = "generation_gWh")
View(gwh_2011_2012_long)
data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
#remove all spaces, and convert comma to dot
gwh_2011_2019$generation_gWh <- sub(",", ".", gwh_2011_2019$gWh, fixed = TRUE)
gwh_2011_2019 <- gwh_2011_2019 %>%  mutate(generation_gWh = str_remove(generation_gWh, "\\s"))
gwh_2011_2019[3]
#write csv
write_csv(gwh_2011_2019, "data_demand_forecast/gwh_2011_2019.csv")
gwh_2011_2019[3]
#remove all spaces, and convert comma to dot
gwh_2011_2019$generation_gWh <- sub(",", ".", gwh_2011_2019$gWh, fixed = TRUE)
#remove all spaces, and convert comma to dot
gwh_2011_2019$generation_gWh <- sub(",", ".", gwh_2011_2019$generation_gWh, fixed = TRUE)
gwh_2011_2019 <- gwh_2011_2019 %>%  mutate(generation_gWh = str_remove(generation_gWh, "\\s"))
gwh_2011_2019[3]
#write csv
write_csv(gwh_2011_2019, "data_demand_forecast/gwh_2011_2019.csv")
library(readxl)
library(tidyverse)
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys")
col1 = "province" #column 1 heading
col2 = "year" #column 2 heading
col3 = "generation (gWh)" #column 3 heading
# generation data (GWh) from BPS, stored locally in github folder
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:C37", col_names = TRUE)
names(gwh_2011_2012)[1] <- col1
View(gwh_2011_2012)
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2013_2015)[1] <- col1
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2017_2019.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2017_2019)[1] <- col1
gwh_2011_2012_long <- pivot_longer(gwh_2011_2012, cols = 2:3, names_to = col2, values_to = col3)
gwh_2013_2015_long <- pivot_longer(gwh_2013_2015, cols = 2:4, names_to = col2, values_to = col3)
gwh_2017_2019_long <- pivot_longer(gwh_2017_2019, cols = 2:4, names_to = col2, values_to = col3)
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
View(gwh_2011_2019)
#remove all spaces, and convert comma to dot
gwh_2011_2019[3] <- sub(",", ".", gwh_2011_2019$generation_gWh, fixed = TRUE)
#remove all spaces, and convert comma to dot
gwh_2011_2019[3] <- sub(",", ".", gwh_2011_2019[3], fixed = TRUE)
View(gwh_2011_2019)
#remove all spaces, and convert comma to dot
gwh_2011_2019[3] <- sub(",", ".", gwh_2011_2019$"col3", fixed = TRUE)
#remove all spaces, and convert comma to dot
gwh_2011_2019[3] <- sub(",", ".", gwh_2011_2019$"col3", fixed = TRUE)
#remove all spaces, and convert comma to dot
gwh_2011_2019[3] <- sub(",", ".", gwh_2011_2019$col3, fixed = TRUE)
#remove all spaces, and convert comma to dot
gwh_2011_2019[3] <- sub(",", ".", gwh_2011_2019$'col3', fixed = TRUE)
#remove all spaces, and convert comma to dot
gwh_2011_2019[3] <- sub(",", ".", gwh_2011_2019$`generation (gWh)`, fixed = TRUE)
gwh_2011_2019 <- gwh_2011_2019 %>%  mutate(`generation (gWh)` = str_remove(`generation (gWh)`, "\\s"))
gwh_2011_2019[3]
#remove all spaces, and convert comma to dot
gwh_2011_2019[3] <- sub(",", ".", gwh_2011_2019$`generation (gWh)`, fixed = TRUE)
library(readxl)
library(tidyverse)
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys")
col1 = "province" #column 1 heading
col2 = "year" #column 2 heading
col3 = "generation (gWh)" #column 3 heading
# generation data (GWh) from BPS, stored locally in github folder
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:C37", col_names = TRUE)
names(gwh_2011_2012)[1] <- col1
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2013_2015)[1] <- col1
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2017_2019.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2017_2019)[1] <- col1
#create long pivoted data
gwh_2011_2012_long <- pivot_longer(gwh_2011_2012, cols = 2:3, names_to = col2, values_to = col3)
gwh_2013_2015_long <- pivot_longer(gwh_2013_2015, cols = 2:4, names_to = col2, values_to = col3)
gwh_2017_2019_long <- pivot_longer(gwh_2017_2019, cols = 2:4, names_to = col2, values_to = col3)
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
#remove all spaces, and convert comma to dot
gwh_2011_2019[3] <- sub(",", ".", gwh_2011_2019$`generation (gWh)`, fixed = TRUE)
gwh_2011_2019 <- gwh_2011_2019 %>%  mutate(`generation (gWh)` = str_remove(`generation (gWh)`, "\\s"))
gwh_2011_2019[3]
#remove all spaces, and convert comma to dot
gwh_2011_2019[3] <- sub(",", ".", gwh_2011_2019$`generation (gWh)`, fixed = TRUE)
gwh_2011_2019 <- gwh_2011_2019 %>%  mutate(`generation (gWh)` = str_remove(`generation (gWh)`, "\\s"))
library(readxl)
library(tidyverse)
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys")
col1 = "province" #column 1 heading
col2 = "year" #column 2 heading
col3 = "generation_gWh" #column 3 heading
# generation data (GWh) from BPS, stored locally in github folder
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:C37", col_names = TRUE)
names(gwh_2011_2012)[1] <- col1
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2013_2015)[1] <- col1
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2017_2019.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2017_2019)[1] <- col1
#create long pivoted data
gwh_2011_2012_long <- pivot_longer(gwh_2011_2012, cols = 2:3, names_to = col2, values_to = col3)
gwh_2013_2015_long <- pivot_longer(gwh_2013_2015, cols = 2:4, names_to = col2, values_to = col3)
gwh_2017_2019_long <- pivot_longer(gwh_2017_2019, cols = 2:4, names_to = col2, values_to = col3)
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
#remove all spaces, and convert comma to dot
gwh_2011_2019[3] <- sub(",", ".", gwh_2011_2019$`generation (gWh)`, fixed = TRUE)
gwh_2011_2019 <- gwh_2011_2019 %>%  mutate(`generation (gWh)` = str_remove(`generation (gWh)`, "\\s"))
gwh_2011_2019[3]
#write csv
write_csv(gwh_2011_2019, "data_demand_forecast/gwh_2011_2019.csv")
col3 = "gen_gWh" #column 3 heading
# generation data (GWh) from BPS, stored locally in github folder
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:C37", col_names = TRUE)
names(gwh_2011_2012)[1] <- col1
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2013_2015)[1] <- col1
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2017_2019.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2017_2019)[1] <- col1
#create long pivoted data
gwh_2011_2012_long <- pivot_longer(gwh_2011_2012, cols = 2:3, names_to = col2, values_to = col3)
gwh_2013_2015_long <- pivot_longer(gwh_2013_2015, cols = 2:4, names_to = col2, values_to = col3)
gwh_2017_2019_long <- pivot_longer(gwh_2017_2019, cols = 2:4, names_to = col2, values_to = col3)
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
#remove all spaces, and convert comma to dot
gwh_2011_2019[3] <- sub(",", ".", gwh_2011_2019$gen_gWh, fixed = TRUE)
gwh_2011_2019 <- gwh_2011_2019 %>%  mutate(gen_gWh = str_remove(gen_gWh, "\\s"))
gwh_2011_2019[3]
#write csv
write_csv(gwh_2011_2019, "data_demand_forecast/gwh_2011_2019.csv")
#remove all spaces, and convert comma to dot
gwh_2011_2019[3] <- sub(",", ".", gwh_2011_2019$gen_gWh, fixed = TRUE)
gwh_2011_2019[3] <- sub("-", "NA", gwh_2011_2019$gen_gWh, fixed = TRUE)
gwh_2011_2019 <- gwh_2011_2019 %>%  mutate(gen_gWh = str_remove(gen_gWh, "\\s"))
gwh_2011_2019[3]
#write csv
write_csv(gwh_2011_2019, "data_demand_forecast/gwh_2011_2019.csv")
library(readxl)
library(tidyverse)
setwd("C:/Users/Brajamusthi/OneDrive/Master of Energy Research/Github/ArchEnSys")
# generation data (GWh) from BPS, stored locally in github folder
gwh_2011_2012 <- read_excel("data_demand_forecast/gWh/generation_gwh_2011_2012.xlsx", range = "A2:C37", col_names = TRUE)
names(gwh_2011_2012)[1] <- col1
gwh_2013_2015 <- read_excel("data_demand_forecast/gWh/generation_gwh_2013_2015.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2013_2015)[1] <- col1
gwh_2017_2019 <- read_excel("data_demand_forecast/gWh/generation_gwh_2017_2019.xlsx", range = "A2:D37", col_names = TRUE)
names(gwh_2017_2019)[1] <- col1
#create long pivoted data
gwh_2011_2012_long <- pivot_longer(gwh_2011_2012, cols = 2:3, names_to = "year", values_to = "gen_gwh")
gwh_2013_2015_long <- pivot_longer(gwh_2013_2015, cols = 2:4, names_to = "year", values_to = "gen_gwh")
gwh_2017_2019_long <- pivot_longer(gwh_2017_2019, cols = 2:4, names_to = "year", values_to = "gen_gwh")
#merge all data
gwh_2011_2019 <- rbind(gwh_2011_2012_long,gwh_2013_2015_long,gwh_2017_2019_long)
#remove all spaces, and convert comma to dot, replace "-" with NA
gwh_2011_2019[3] <- sub(",", ".", gwh_2011_2019$gen_gwh, fixed = TRUE)
gwh_2011_2019[3] <- sub("-", "NA", gwh_2011_2019$gen_gwh, fixed = TRUE)
gwh_2011_2019 <- gwh_2011_2019 %>%  mutate(gen_gwh = str_remove(gen_gwh, "\\s"))
gwh_2011_2019[3]
#write csv
write_csv(gwh_2011_2019, "data_demand_forecast/gwh_2011_2019.csv")
